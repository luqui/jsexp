<html>
 <head>
  <script src="jquery.min.js"></script>
  <script src="../structural.js"></script>

  <style>
   .eatom { color: red }
   .selected { background: #fdd }
   .box { background: lightgreen }
  </style>

  <script>
$(function() {

var container = elt('div');
$(document.body).append(container);

var update = function(z) {
    container.empty();
    container.append(elt('pre', {}, render_zipper(z)));
};

var zipper = new Zipper([], Exp_eplus_box.make());

update(zipper);

var unfocus = function() {
    if (typeof(zipper.expr) !== 'string' && zipper.expr.head.unfocus) {     
        zipper = zipper.expr.head.unfocus(zipper) 
    }
};

$(document.body).keydown(function(e) {
    if (37 == e.which) { // left
        unfocus();
        update(zipper = zipper.left());
    }
    else if (38 == e.which) { // up
        unfocus();
        update(zipper = zipper.up());
    }
    else if (39 == e.which) { // right
        unfocus();
        update(zipper = zipper.right());
    }
    else if (40 == e.which) { // down
        unfocus();
        update(zipper = zipper.down(0));
    }
    else {
        //console.log(e.which, e.charCode);
    }
});

$(document.body).keypress(function(e) {
    if (typeof(zipper.expr) !== 'string') {
        var ch = String.fromCharCode(e.charCode);
        var tokresult = zipper.expr.head.parse(zipper)(ch);
        if (tokresult) {
            update(zipper = tokresult[0]);
        }
    }
});

});
  </script>
 </head>
 <body>
 </body>
</html>
